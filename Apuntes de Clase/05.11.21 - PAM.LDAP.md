-----------
-- PAM LDAP --
-----------

<!---
# Plantilla H1
## Plantilla H2
### Plantilla H3
-->
<!--- <img src="https://phoneky.co.uk/thumbs/screensavers/down/original/linux_3rj131p8.gif" />
-->

‚≠êÔ∏è **PLANTILLA** ‚≠êÔ∏è

| üî•PLANTILLA TALBA‚ùóüî• | 
| ------------- |
| *Plantilla* |


--------------------------------------------------------------------------------

‚≠êÔ∏è **IMPLANTACI√ì DEL SERVEI NSS-PAM-LDAP** ‚≠êÔ∏è

1. Instal¬∑lar el paquet de nss-pam-ldapd.

**nss-pam-ldap**

En Debian:

nslcd

nslcd-utils

libpam-ldapd

libnss-ldapd

Procediment b√†sic:
* Instal¬∑lar nss-pam-ldapd
* Configurar el client ldap.conf.
* Configurar la resoluci√≥ de noms amb nsswitch.conf.
* Configurar el servei nslcd. Cal configurar l‚Äôac√©ss nslcd a la base de dades ldap (uri,
bas).
* Engegar els serveis slapd, nscd i nslcd.
* Comprovar amb l‚Äôordre getent passwd, getent group i getent hosts que la resoluci√≥
de noms utilitza els files locals i el servidor ldap local.
* Atenci√≥: cal usar la base de dades LDAP que cont√© correctament configurats els
usuaris en el DN per uid i assignats apropiadament als seus grups.

Utilitzar l'ordre getent.

getent passwd
getent passwd pere
getent group
getent group 2hisx

**Autenticaci√≥ PAM_LDAP.SO**

Procediment autenticaci√≥ PAM::
* Amb getent verificar que es llisten i es consulten les dades d‚Äôusuaris i grups locals i
de ldap. Si no fos aix√≠ instal¬∑lar el client de ldap (openldap-clients) i verificar que hi ha
accessibilitat al servidor.

* Practicar fent modificacions al PAM passwd per permetre modificar els password als
usuaris locals i als usuaris ldap. Utilitzar pam_ldap.so.

* Modificar system-auth per tal d‚Äôestablir l‚Äôautenticaci√≥ permetent usuaris locals i
usuaris LDAP.

* Establir preced√®ncia entre local / ldap. Provar un cas de prova (Pere duplicat).

* Establir que es cre√Ø autom√†ticament els homes dels usuaris de ldap amb
pam_mkhomedir.so.

**Se usa el LDAP Group**





-------------------------------------------------------------------------------- 

Configura el container PAM (--privileged) per:

* Permetre l‚Äôautenticaci√≥ local dels usuaris unix locals (unix01, unix02 i unix03).

* Permetre l‚Äôautenticaci√≥ d‚Äôusuaris de LDAP.

Per fer-ho s‚Äôutilitzar√† la imatge ldap21/grup que cont√© el llistat final d‚Äôusuaris i grups
LDAP amb els que treballar.

* Als usuaris LDAP se‚Äôls ha de crear el directori home autom√†ticament si no existeix.

* Als usuaris LDAP se‚Äôls ha de crear un recurs temporal, dins del home anomenat tmp.

Un ramdisk de tipus tmpfs de 100M.

* Tots els usuaris han de poder modificar-se el password. Els usuaris locals i tamb√©
els usuaris de LDAP.

Atenci√≥: potser cal refer la configuraci√≥ ACL de la base de dades LDAP edt.org per
permetre que els usuaris es puguin modificar el seu password.



Metodologia de treball recomanada:

* Es recomana fer una copia de pam21:base i generar pam1:ldap.

* Treballar interactivament amb aquesta nova imatge afegint els paquets de PAM
LDAP i NSS. Observar les opcions de configuraci√≥ que demana Debian en instal¬∑lar
aquests paquets i en quins fitxers afecten aquestes configuracions.

* Manualment engegar els serveis nscd i nslcd.

Verificar:

* Si est√† ben configurat l‚Äôacc√©s LDAP, nsswitch, nscd i nslcd lavors les ordres
getent han de funcionar correctament (gent passwd i getent group).

‚óã Si tamb√© es configura els fitxers de PAM (auth, acount, session i password)
llavors l‚Äôautenticaci√≥ amb usuaris linux i unix √©s total.

* Un cop interactivament s‚Äôha constru√Øt un container que autentica correctament unix i
ldap cal generar automatitzadament la imatge pam21:ldap a trav√©s del Dockerfile.
Observacions:

* Observeu que en el proc√©s d‚Äôinstal¬∑laci√≥ i configuraci√≥ interctiu amb Debian sembla
que tot es configura apropiadament i l‚Äôautenticaci√≥ d‚Äôusuaris est√† molt m√©s afinada.

* En canvi si ho feu manaualment sembla que queden ‚Äòdetals‚Äô per tunejar de manra
que l‚Äôautenticaci√≥ √©s m√©s ‚Äòaspre‚Äô.

* Mireu d‚Äôesbrinar quins s√≥n tot els canvis de configuraci√≥ que fa autom√†ticament la
instal¬∑laci√≥ interactiva per propagar-los a la configuraci√≥ del Dockerfile.













-------------------------------------------------------------------------------- 

‚≠êÔ∏è **IMPLANTACI√ìN** ‚≠êÔ∏è

















-------------------------------------------------------------------------------- 

‚≠êÔ∏è **COMPROBACI√ìN** ‚≠êÔ∏è

















-------------------------------------------------------------------------------- 


[FALTA AUTENTICACI√ìN DE USUARIOS DENTRO]

LOS FICHEROS EST√ÅN SEPARADOS 

COMMON AUTH

COMMON SESSION

COMMON PASSWORD...
















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 
